---
description: noLimitTranslate エージェントのプロジェクト固有ルールと制約。
---
# noLimitTranslate エージェントルール

## 核となる哲学
1.  **クライアントサイドのみ**: すべてのロジックはブラウザ内で実行されなければなりません。静的アセットの配信を除き、サーバーサイドの API ルートやバックエンドロジックを実装してはいけません。
2.  **プライバシー優先**: ユーザーの入力データがデバイス外に出ないことを保証してください。
3.  **パフォーマンス**: メインスレッドの応答性を維持してください。重い処理（推論）は必ず Web Worker で実行しなければなりません。

## 技術スタックの制約
-   **フレームワーク**: Next.js (App Router)。`output: 'export'` (Static Site Generation) と互換性がある必要があります。
-   **スタイリング**: Tailwind CSS v4。カスタム変数は `@theme` を使用してください。可能な限りインラインスタイルは避けてください。
-   **ステート管理**: グローバルステートには Zustand を使用してください。翻訳ステータスの管理に props のバケツリレーを行わないでください。
-   **AI エンジン**: `@huggingface/transformers` (v4.0.0-next.3)。原則として最新の WebGPU ランタイムを利用します。
-   **メモリ管理**: GPU モデル（4B以上）を扱う際は、ブラウザのバッファ制約（~2GB）を考慮し、必ず `dtype: 'q4'` を使用し、失敗時の軽量モデル（NLLB等）へのフォールバックを実装してください。
-   **デバッグ**: 数値型のエラーコード（例: 12292832）は WebGPU/WASM の内部エラー（多くは OOM）であるため、ユーザーに分かりやすいメッセージに変換してください。

## コードスタイル
-   **TypeScript**: Strict モード。どうしても必要な場合（かつコメントで理由を説明できる場合）を除き、`any` は使用禁止です。
-   **コンポーネント**: 名前付きエクスポートを持つ関数コンポーネントを使用してください。
-   **ディレクトリ構造**:
    -   `src/lib/worker.ts`: モデル推論ロジックを置く **唯一の** 場所です。
    -   `src/components/translation/`: ドメイン固有の UI コンポーネントフォルダです。

## デプロイ
-   ターゲット: Cloudflare Pages。
-   ビルドコマンド: `npm run build` (内部で `next build --webpack` を実行)。
-   出力ディレクトリ: `out`。
